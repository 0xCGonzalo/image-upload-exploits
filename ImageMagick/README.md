## ImageMagick attacks

ImageMagick is popular library for image processing. And this library has many vulnerabilities such as RCE, SSRF, Memory Leaks, DoS and others.

This section contains exploits for various vulnerabilities.

### Some useful tricks
1) If the application prohibits processing files with the extension that you need for one of the exploits (for example XBM, EPS) just try to change the extension to the allowed (PNG,JPEG). ImageMagick recognize the file format by it's content.
2) If you found memory leak vulnerability - try to automate exploataion. Write a script that will upload the images and then extract the leaked information, this will allow you to get different sections of memory in a short time, so that you can find sensitive data.

### ImageTragick 

The most famous bug related to ImageMagick. T



### GhostScript

GhostScript is interpreter for PostScript. Vulnerabilities in GhostScript affects ImageMagick because it uses GhostScript for processing PostScript files like a PDF, EPS, PS, XPS. Of course, if you found a application that handling these file types without ImageMagick, you can also try these exploits.
In GhostScript section you can find RCE PoC for CVE-2017–8291 and CVE-2018–16509.

[Franz Rosen, Semrush BugBounty](https://hackerone.com/reports/403417)

### Gifoeb (CVE-2017-15277)

Memory leak due to an error in processing GIF images. This bug was discovered by Emil Lerner. He also created a [PoC](https://github.com/neex/gifoeb) that allows you to extract data from the resulted image. This vulnerability is often found in applications that allow you to upload images and then process them, for example, resize.

You can use **gifoeb.gif** file to detect if application is vulnerable for this. If application is vulnerable you will see something like this:
PIC
then use Emil's [PoC](https://github.com/neex/gifoeb) for futher exploataion.

[Eray Mitrani, Twitter BB](https://hackerone.com/reports/315906)

### XBM memory leak (CVE-2018-16323)

Another memory leak. Vulnerability in processing XBM images. The vulnerability was discovered by Fedotkin Zakhar (d4d), he created a [PoC](https://github.com/d0ge/xbmdump) . 
Also there is about this bug [article](https://medium.com/@ilja.bv/yet-another-
memory-leak-in-imagemagick-or-how-to-exploit-cve-2018-16323-a60f048a1e12) wrote by me and @ttffdd, and alternative [PoC](https://github.com/ttffdd/XBadManners) by ttffdd